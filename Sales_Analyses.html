<html>

<head>
<style type="text/css">
.inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
}
.warning {
	font-weight: bold;
}
.message {
	font-style: italic;
}
.source, .output, .warning, .error, .message {
	padding: 0 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f5f5f5;
}
.left {
  text-align: left;
}
.right {
  text-align: right;
}
.center {
  text-align: center;
}
.hl.num {
  color: #AF0F91;
}
.hl.str {
  color: #317ECC;
}
.hl.com {
  color: #AD95AF;
  font-style: italic;
}
.hl.opt {
  color: #000000;
}
.hl.std {
  color: #585858;
}
.hl.kwa {
  color: #295F94;
  font-weight: bold;
}
.hl.kwb {
  color: #B05A65;
}
.hl.kwc {
  color: #55aa55;
}
.hl.kwd {
  color: #BC5A65;
  font-weight: bold;
}
</style>
<title>Sales_Analyses</title>
</head>

<body>

<p>This is an R HTML document. When you click the <b>Knit HTML</b> button a web page will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:</p>

<div class="chunk" id="unnamed-chunk-1"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl kwd">install.packages</span><span class="hl std">(</span><span class="hl str">&quot;readxl&quot;</span><span class="hl std">)</span>
</pre></div>
<div class="message"><pre class="knitr r">## Installing package into '/usr/local/lib/R/site-library'
## (as 'lib' is unspecified)
</pre></div>
<div class="warning"><pre class="knitr r">## Warning in install.packages(&quot;readxl&quot;): 'lib = &quot;/usr/local/lib/R/site-library&quot;'
## is not writable
</pre></div>
<div class="error"><pre class="knitr r">## Error in install.packages(&quot;readxl&quot;): unable to install packages
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">install.packages</span><span class="hl std">(</span><span class="hl str">&quot;plyr&quot;</span><span class="hl std">)</span>
</pre></div>
<div class="message"><pre class="knitr r">## Installing package into '/usr/local/lib/R/site-library'
## (as 'lib' is unspecified)
</pre></div>
<div class="warning"><pre class="knitr r">## Warning in install.packages(&quot;plyr&quot;): 'lib = &quot;/usr/local/lib/R/site-library&quot;' is
## not writable
</pre></div>
<div class="error"><pre class="knitr r">## Error in install.packages(&quot;plyr&quot;): unable to install packages
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">install.packages</span><span class="hl std">(</span><span class="hl str">&quot;dplyr&quot;</span><span class="hl std">)</span>
</pre></div>
<div class="message"><pre class="knitr r">## Installing package into '/usr/local/lib/R/site-library'
## (as 'lib' is unspecified)
</pre></div>
<div class="warning"><pre class="knitr r">## Warning in install.packages(&quot;dplyr&quot;): 'lib = &quot;/usr/local/lib/R/site-library&quot;' is
## not writable
</pre></div>
<div class="error"><pre class="knitr r">## Error in install.packages(&quot;dplyr&quot;): unable to install packages
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">install.packages</span><span class="hl std">(</span><span class="hl str">&quot;caTools&quot;</span><span class="hl std">)</span>
</pre></div>
<div class="message"><pre class="knitr r">## Installing package into '/usr/local/lib/R/site-library'
## (as 'lib' is unspecified)
</pre></div>
<div class="warning"><pre class="knitr r">## Warning in install.packages(&quot;caTools&quot;): 'lib = &quot;/usr/local/lib/R/site-library&quot;'
## is not writable
</pre></div>
<div class="error"><pre class="knitr r">## Error in install.packages(&quot;caTools&quot;): unable to install packages
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">install.packages</span><span class="hl std">(</span><span class="hl str">&quot;e1071&quot;</span><span class="hl std">)</span>
</pre></div>
<div class="message"><pre class="knitr r">## Installing package into '/usr/local/lib/R/site-library'
## (as 'lib' is unspecified)
</pre></div>
<div class="warning"><pre class="knitr r">## Warning in install.packages(&quot;e1071&quot;): 'lib = &quot;/usr/local/lib/R/site-library&quot;' is
## not writable
</pre></div>
<div class="error"><pre class="knitr r">## Error in install.packages(&quot;e1071&quot;): unable to install packages
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">install.packages</span><span class="hl std">(</span><span class="hl str">&quot;caret&quot;</span><span class="hl std">)</span>
</pre></div>
<div class="message"><pre class="knitr r">## Installing package into '/usr/local/lib/R/site-library'
## (as 'lib' is unspecified)
</pre></div>
<div class="warning"><pre class="knitr r">## Warning in install.packages(&quot;caret&quot;): 'lib = &quot;/usr/local/lib/R/site-library&quot;' is
## not writable
</pre></div>
<div class="error"><pre class="knitr r">## Error in install.packages(&quot;caret&quot;): unable to install packages
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">install.packages</span><span class="hl std">(</span><span class="hl str">&quot;randomForest&quot;</span><span class="hl std">)</span>
</pre></div>
<div class="message"><pre class="knitr r">## Installing package into '/usr/local/lib/R/site-library'
## (as 'lib' is unspecified)
</pre></div>
<div class="warning"><pre class="knitr r">## Warning in install.packages(&quot;randomForest&quot;): 'lib = &quot;/usr/local/lib/R/site-
## library&quot;' is not writable
</pre></div>
<div class="error"><pre class="knitr r">## Error in install.packages(&quot;randomForest&quot;): unable to install packages
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">install.packages</span><span class="hl std">(</span><span class="hl str">&quot;pscl&quot;</span><span class="hl std">)</span>
</pre></div>
<div class="message"><pre class="knitr r">## Installing package into '/usr/local/lib/R/site-library'
## (as 'lib' is unspecified)
</pre></div>
<div class="warning"><pre class="knitr r">## Warning in install.packages(&quot;pscl&quot;): 'lib = &quot;/usr/local/lib/R/site-library&quot;' is
## not writable
</pre></div>
<div class="error"><pre class="knitr r">## Error in install.packages(&quot;pscl&quot;): unable to install packages
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># import necessary libraries</span>

<span class="hl kwd">library</span><span class="hl std">(readxl)</span>
<span class="hl com"># to read excel</span>
<span class="hl kwd">library</span><span class="hl std">(plyr)</span>
<span class="hl kwd">library</span><span class="hl std">(dplyr)</span>
</pre></div>
<div class="message"><pre class="knitr r">## 
## Attaching package: 'dplyr'
</pre></div>
<div class="message"><pre class="knitr r">## The following objects are masked from 'package:plyr':
## 
##     arrange, count, desc, failwith, id, mutate, rename, summarise,
##     summarize
</pre></div>
<div class="message"><pre class="knitr r">## The following objects are masked from 'package:stats':
## 
##     filter, lag
</pre></div>
<div class="message"><pre class="knitr r">## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">library</span><span class="hl std">(caTools)</span>
<span class="hl kwd">library</span><span class="hl std">(e1071)</span>
<span class="hl kwd">library</span><span class="hl std">(caret)</span>
</pre></div>
<div class="message"><pre class="knitr r">## Loading required package: lattice
</pre></div>
<div class="message"><pre class="knitr r">## Loading required package: ggplot2
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">library</span><span class="hl std">(randomForest)</span>
</pre></div>
<div class="message"><pre class="knitr r">## randomForest 4.6-14
</pre></div>
<div class="message"><pre class="knitr r">## Type rfNews() to see new features/changes/bug fixes.
</pre></div>
<div class="message"><pre class="knitr r">## 
## Attaching package: 'randomForest'
</pre></div>
<div class="message"><pre class="knitr r">## The following object is masked from 'package:ggplot2':
## 
##     margin
</pre></div>
<div class="message"><pre class="knitr r">## The following object is masked from 'package:dplyr':
## 
##     combine
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">library</span><span class="hl std">(ggplot2)</span>
<span class="hl kwd">library</span><span class="hl std">(lattice)</span>

<span class="hl kwd">library</span><span class="hl std">(readxl)</span>
<span class="hl std">attrib1</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">read_excel</span><span class="hl std">(</span><span class="hl str">&quot;Attribute DataSet.xlsx&quot;</span><span class="hl std">)</span>
<span class="hl kwd">View</span><span class="hl std">(attrib1)</span>
</pre></div>
<div class="warning"><pre class="knitr r">## Warning in View(attrib1): unable to open display
</pre></div>
<div class="error"><pre class="knitr r">## Error in .External2(C_dataviewer, x, title): unable to start data viewer
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">library</span><span class="hl std">(readxl)</span>
<span class="hl std">dresssale1</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">read_excel</span><span class="hl std">(</span><span class="hl str">&quot;Dress Sales.xlsx&quot;</span><span class="hl std">)</span>
<span class="hl kwd">View</span><span class="hl std">(dresssale1)</span>
</pre></div>
<div class="warning"><pre class="knitr r">## Warning in View(dresssale1): unable to open display
</pre></div>
<div class="error"><pre class="knitr r">## Error in .External2(C_dataviewer, x, title): unable to start data viewer
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">attrib1</span> <span class="hl kwb">=</span> <span class="hl kwd">read_excel</span><span class="hl std">(</span><span class="hl str">'Attribute DataSet.xlsx'</span><span class="hl std">)</span>
<span class="hl std">dresssale1</span> <span class="hl kwb">=</span> <span class="hl kwd">read_excel</span><span class="hl std">(</span><span class="hl str">'Dress Sales.xlsx'</span><span class="hl std">)</span>

<span class="hl com">#remove Dress_ID column</span>
<span class="hl std">attrib2</span> <span class="hl kwb">=</span> <span class="hl std">attrib1[</span><span class="hl num">2</span><span class="hl opt">:</span><span class="hl num">14</span><span class="hl std">]</span>
<span class="hl std">dresssale2</span> <span class="hl kwb">=</span> <span class="hl std">dresssale1[</span><span class="hl num">2</span><span class="hl opt">:</span><span class="hl num">24</span><span class="hl std">]</span>

<span class="hl com"># check the unique values for each columns</span>
<span class="hl kwd">lapply</span><span class="hl std">(attrib2, unique)</span>
</pre></div>
<div class="output"><pre class="knitr r">## $Style
##  [1] &quot;Sexy&quot;     &quot;Casual&quot;   &quot;vintage&quot;  &quot;Brief&quot;    &quot;cute&quot;     &quot;bohemian&quot;
##  [7] &quot;Novelty&quot;  &quot;Flare&quot;    &quot;party&quot;    &quot;sexy&quot;     &quot;work&quot;     &quot;OL&quot;      
## [13] &quot;fashion&quot; 
## 
## $Price
## [1] &quot;Low&quot;       &quot;High&quot;      &quot;Average&quot;   &quot;Medium&quot;    &quot;very-high&quot; &quot;low&quot;      
## [7] &quot;high&quot;      NA         
## 
## $Rating
##  [1] 4.6 0.0 4.5 5.0 4.7 4.8 4.3 4.0 4.4 4.9 4.2 3.6 3.7 4.1 3.5 1.0 3.0
## 
## $Size
## [1] &quot;M&quot;     &quot;L&quot;     &quot;XL&quot;    &quot;free&quot;  &quot;S&quot;     &quot;small&quot; &quot;s&quot;    
## 
## $Season
## [1] &quot;Summer&quot; &quot;Automn&quot; &quot;Spring&quot; &quot;Winter&quot; &quot;spring&quot; &quot;winter&quot; NA       &quot;summer&quot;
## [9] &quot;Autumn&quot;
## 
## $NeckLine
##  [1] &quot;o-neck&quot;          &quot;v-neck&quot;          &quot;boat-neck&quot;       &quot;peterpan-collor&quot;
##  [5] &quot;ruffled&quot;         &quot;turndowncollor&quot;  &quot;slash-neck&quot;      &quot;mandarin-collor&quot;
##  [9] &quot;open&quot;            &quot;sqare-collor&quot;    &quot;Sweetheart&quot;      &quot;sweetheart&quot;     
## [13] NA                &quot;Scoop&quot;           &quot;halter&quot;          &quot;backless&quot;       
## [17] &quot;bowneck&quot;         &quot;NULL&quot;           
## 
## $SleeveLength
##  [1] &quot;sleevless&quot;      &quot;Petal&quot;          &quot;full&quot;           &quot;butterfly&quot;     
##  [5] &quot;short&quot;          &quot;threequarter&quot;   &quot;halfsleeve&quot;     &quot;cap-sleeves&quot;   
##  [9] &quot;turndowncollor&quot; &quot;threequater&quot;    &quot;capsleeves&quot;     &quot;sleeveless&quot;    
## [13] &quot;sleeevless&quot;     &quot;half&quot;           &quot;urndowncollor&quot;  &quot;thressqatar&quot;   
## [17] &quot;NULL&quot;           &quot;sleveless&quot;     
## 
## $waiseline
## [1] &quot;empire&quot;   &quot;natural&quot;  &quot;null&quot;     NA         &quot;princess&quot; &quot;dropped&quot; 
## 
## $Material
##  [1] &quot;null&quot;          &quot;microfiber&quot;    &quot;polyster&quot;      &quot;silk&quot;         
##  [5] &quot;chiffonfabric&quot; &quot;cotton&quot;        &quot;nylon&quot;         &quot;other&quot;        
##  [9] &quot;milksilk&quot;      &quot;linen&quot;         &quot;rayon&quot;         &quot;lycra&quot;        
## [13] &quot;mix&quot;           &quot;acrylic&quot;       &quot;spandex&quot;       &quot;lace&quot;         
## [17] &quot;modal&quot;         &quot;cashmere&quot;      NA              &quot;viscos&quot;       
## [21] &quot;knitting&quot;      &quot;sill&quot;          &quot;wool&quot;          &quot;model&quot;        
## [25] &quot;shiffon&quot;      
## 
## $FabricType
##  [1] &quot;chiffon&quot;    &quot;null&quot;       &quot;broadcloth&quot; &quot;jersey&quot;     &quot;other&quot;     
##  [6] &quot;batik&quot;      &quot;satin&quot;      &quot;flannael&quot;   &quot;worsted&quot;    &quot;woolen&quot;    
## [11] &quot;poplin&quot;     &quot;dobby&quot;      &quot;knitting&quot;   &quot;flannel&quot;    &quot;tulle&quot;     
## [16] &quot;sattin&quot;     NA           &quot;organza&quot;    &quot;lace&quot;       &quot;Corduroy&quot;  
## [21] &quot;wollen&quot;     &quot;knitted&quot;    &quot;shiffon&quot;    &quot;terry&quot;     
## 
## $Decoration
##  [1] &quot;ruffles&quot;    &quot;null&quot;       &quot;embroidary&quot; &quot;bow&quot;        &quot;lace&quot;      
##  [6] &quot;beading&quot;    &quot;sashes&quot;     &quot;hollowout&quot;  &quot;pockets&quot;    &quot;sequined&quot;  
## [11] &quot;applique&quot;   &quot;button&quot;     &quot;Tiered&quot;     &quot;rivet&quot;      &quot;feathers&quot;  
## [16] &quot;flowers&quot;    &quot;pearls&quot;     NA           &quot;pleat&quot;      &quot;crystal&quot;   
## [21] &quot;ruched&quot;     &quot;draped&quot;     &quot;tassel&quot;     &quot;plain&quot;      &quot;none&quot;      
## [26] &quot;cascading&quot; 
## 
## $`Pattern Type`
##  [1] &quot;animal&quot;    &quot;print&quot;     &quot;dot&quot;       &quot;solid&quot;     &quot;null&quot;      &quot;patchwork&quot;
##  [7] &quot;striped&quot;   &quot;geometric&quot; &quot;plaid&quot;     &quot;leopard&quot;   &quot;floral&quot;    &quot;character&quot;
## [13] NA          &quot;splice&quot;    &quot;leapord&quot;   &quot;none&quot;     
## 
## $Recommendation
## [1] 1 0
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># values checking</span>
<span class="hl std">attrib2</span><span class="hl opt">$</span><span class="hl std">Style</span><span class="hl kwb">&lt;-</span><span class="hl kwd">mapvalues</span><span class="hl std">(attrib2</span><span class="hl opt">$</span><span class="hl std">Style,</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'sexy'</span><span class="hl std">),</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'Sexy'</span><span class="hl std">))</span>
<span class="hl std">attrib2</span><span class="hl opt">$</span><span class="hl std">Price</span><span class="hl kwb">&lt;-</span><span class="hl kwd">mapvalues</span><span class="hl std">(attrib2</span><span class="hl opt">$</span><span class="hl std">Price,</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'low'</span><span class="hl std">,</span><span class="hl str">'high'</span><span class="hl std">),</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'Low'</span><span class="hl std">,</span><span class="hl str">'High'</span><span class="hl std">))</span>
<span class="hl std">attrib2</span><span class="hl opt">$</span><span class="hl std">Size</span><span class="hl kwb">&lt;-</span><span class="hl kwd">mapvalues</span><span class="hl std">(attrib2</span><span class="hl opt">$</span><span class="hl std">Size,</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'s'</span><span class="hl std">,</span><span class="hl str">'small'</span><span class="hl std">),</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'S'</span><span class="hl std">,</span><span class="hl str">'S'</span><span class="hl std">))</span>
<span class="hl std">attrib2</span><span class="hl opt">$</span><span class="hl std">Season</span><span class="hl kwb">&lt;-</span><span class="hl kwd">mapvalues</span><span class="hl std">(attrib2</span><span class="hl opt">$</span><span class="hl std">Season,</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'spring'</span><span class="hl std">,</span><span class="hl str">'summer'</span><span class="hl std">,</span><span class="hl str">'Automn'</span><span class="hl std">,</span><span class="hl str">'winter'</span><span class="hl std">),</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'Spring'</span><span class="hl std">,</span><span class="hl str">'Summer'</span><span class="hl std">,</span><span class="hl str">'Autumn'</span><span class="hl std">,</span><span class="hl str">'Winter'</span><span class="hl std">))</span>
<span class="hl std">attrib2</span><span class="hl opt">$</span><span class="hl std">NeckLine</span><span class="hl kwb">&lt;-</span><span class="hl kwd">mapvalues</span><span class="hl std">(attrib2</span><span class="hl opt">$</span><span class="hl std">NeckLine,</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'sweetheart'</span><span class="hl std">),</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'Sweetheart'</span><span class="hl std">))</span>
<span class="hl std">attrib2</span><span class="hl opt">$</span><span class="hl std">SleeveLength</span><span class="hl kwb">&lt;-</span><span class="hl kwd">mapvalues</span><span class="hl std">(attrib2</span><span class="hl opt">$</span><span class="hl std">SleeveLength,</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'sleevless'</span><span class="hl std">,</span><span class="hl str">'sleeevless'</span><span class="hl std">,</span><span class="hl str">'sleveless'</span><span class="hl std">,</span><span class="hl str">'threequater'</span><span class="hl std">,</span><span class="hl str">'thressqatar'</span><span class="hl std">,</span><span class="hl str">'urndowncollor'</span><span class="hl std">),</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'sleeveless'</span><span class="hl std">,</span><span class="hl str">'sleeveless'</span><span class="hl std">,</span><span class="hl str">'sleeveless'</span><span class="hl std">,</span><span class="hl str">'threequarter'</span><span class="hl std">,</span><span class="hl str">'threequarter'</span><span class="hl std">,</span><span class="hl str">'turndowncollar'</span><span class="hl std">))</span>
<span class="hl std">attrib2</span><span class="hl opt">$</span><span class="hl std">FabricType</span><span class="hl kwb">&lt;-</span><span class="hl kwd">mapvalues</span><span class="hl std">(attrib2</span><span class="hl opt">$</span><span class="hl std">FabricType,</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'shiffon'</span><span class="hl std">,</span><span class="hl str">'sattin'</span><span class="hl std">,</span><span class="hl str">'wollen'</span><span class="hl std">,</span><span class="hl str">'flannael'</span><span class="hl std">,</span><span class="hl str">'knitting'</span><span class="hl std">),</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'chiffon'</span><span class="hl std">,</span><span class="hl str">'satin'</span><span class="hl std">,</span><span class="hl str">'woolen'</span><span class="hl std">,</span><span class="hl str">'flannel'</span><span class="hl std">,</span><span class="hl str">'knitted'</span><span class="hl std">))</span>
<span class="hl std">attrib2</span><span class="hl opt">$</span><span class="hl std">Decoration</span><span class="hl kwb">&lt;-</span><span class="hl kwd">mapvalues</span><span class="hl std">(attrib2</span><span class="hl opt">$</span><span class="hl std">Decoration,</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'embroidary'</span><span class="hl std">,</span><span class="hl str">'sequined'</span><span class="hl std">,</span><span class="hl str">'ruched'</span><span class="hl std">,</span><span class="hl str">'none'</span><span class="hl std">),</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'embroidery'</span><span class="hl std">,</span><span class="hl str">'sequins'</span><span class="hl std">,</span><span class="hl str">'ruche'</span><span class="hl std">,</span><span class="hl str">'null'</span><span class="hl std">))</span>
<span class="hl std">attrib2</span><span class="hl opt">$</span><span class="hl std">`Pattern Type`</span><span class="hl kwb">&lt;-</span><span class="hl kwd">mapvalues</span><span class="hl std">(attrib2</span><span class="hl opt">$</span><span class="hl std">`Pattern Type`,</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'none'</span><span class="hl std">,</span><span class="hl str">'leapord'</span><span class="hl std">),</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'null'</span><span class="hl std">,</span><span class="hl str">'leopard'</span><span class="hl std">))</span>

<span class="hl com"># factoring </span>
<span class="hl kwd">sapply</span><span class="hl std">(attrib2,class)</span>
</pre></div>
<div class="output"><pre class="knitr r">##          Style          Price         Rating           Size         Season 
##    &quot;character&quot;    &quot;character&quot;      &quot;numeric&quot;    &quot;character&quot;    &quot;character&quot; 
##       NeckLine   SleeveLength      waiseline       Material     FabricType 
##    &quot;character&quot;    &quot;character&quot;    &quot;character&quot;    &quot;character&quot;    &quot;character&quot; 
##     Decoration   Pattern Type Recommendation 
##    &quot;character&quot;    &quot;character&quot;      &quot;numeric&quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">cols</span><span class="hl kwb">&lt;-</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;Style&quot;</span><span class="hl std">,</span><span class="hl str">&quot;Price&quot;</span><span class="hl std">,</span><span class="hl str">&quot;Size&quot;</span><span class="hl std">,</span><span class="hl str">&quot;Season&quot;</span><span class="hl std">,</span><span class="hl str">&quot;NeckLine&quot;</span><span class="hl std">,</span><span class="hl str">&quot;SleeveLength&quot;</span><span class="hl std">,</span><span class="hl str">&quot;waiseline&quot;</span><span class="hl std">,</span><span class="hl str">&quot;Material&quot;</span><span class="hl std">,</span>
        <span class="hl str">&quot;FabricType&quot;</span><span class="hl std">,</span><span class="hl str">&quot;Decoration&quot;</span><span class="hl std">,</span><span class="hl str">&quot;Pattern Type&quot;</span><span class="hl std">,</span><span class="hl str">&quot;Recommendation&quot;</span><span class="hl std">)</span>
<span class="hl std">attrib2[cols]</span><span class="hl kwb">&lt;-</span><span class="hl kwd">lapply</span><span class="hl std">(attrib2[cols],factor)</span>
<span class="hl kwd">sapply</span><span class="hl std">(attrib2,class)</span>
</pre></div>
<div class="output"><pre class="knitr r">##          Style          Price         Rating           Size         Season 
##       &quot;factor&quot;       &quot;factor&quot;      &quot;numeric&quot;       &quot;factor&quot;       &quot;factor&quot; 
##       NeckLine   SleeveLength      waiseline       Material     FabricType 
##       &quot;factor&quot;       &quot;factor&quot;       &quot;factor&quot;       &quot;factor&quot;       &quot;factor&quot; 
##     Decoration   Pattern Type Recommendation 
##       &quot;factor&quot;       &quot;factor&quot;       &quot;factor&quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># OR ###</span>
<span class="hl com">#attrib2$Style &lt;- factor(attrib2$Style,levels=unique(attrib2$Style))</span>
<span class="hl com">#table(attrib2$Style)</span>
<span class="hl com">#attrib2$Price &lt;- factor(attrib2$Price,levels=unique(attrib2$Price))</span>
<span class="hl com">#summary(attrib2$Price)</span>
<span class="hl com">#attrib2$Recommendation &lt;- sapply(attrib2$Recommendation, factor)</span>

<span class="hl com"># count of missing values in attrib2 dataset</span>
<span class="hl kwd">colSums</span><span class="hl std">(</span><span class="hl kwd">is.na</span><span class="hl std">(attrib2))</span>
</pre></div>
<div class="output"><pre class="knitr r">##          Style          Price         Rating           Size         Season 
##              0              2              0              0              2 
##       NeckLine   SleeveLength      waiseline       Material     FabricType 
##              1              0              1              1              1 
##     Decoration   Pattern Type Recommendation 
##              1              1              0
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># fill missing Value with mode # Categorical data. So, no use of mean &amp; median. So, use Mode. # The mode is the value that has highest number of occurrences in a set of data. # R does not have a standard in-built function to calculate mode. So we create a user function to calculate mode of a data set in R.</span>
<span class="hl std">getmode</span> <span class="hl kwb">&lt;-</span> <span class="hl kwa">function</span><span class="hl std">(</span><span class="hl kwc">v</span><span class="hl std">) {</span>
  <span class="hl std">uniqv</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">unique</span><span class="hl std">(v)</span>
  <span class="hl std">uniqv[</span><span class="hl kwd">which.max</span><span class="hl std">(</span><span class="hl kwd">tabulate</span><span class="hl std">(</span><span class="hl kwd">match</span><span class="hl std">(v, uniqv)))]</span>
<span class="hl std">}</span>
<span class="hl com"># fill missing Value with mode</span>
<span class="hl std">attrib2</span><span class="hl opt">$</span><span class="hl std">Price[</span><span class="hl kwd">is.na</span><span class="hl std">(attrib2</span><span class="hl opt">$</span><span class="hl std">Price)</span> <span class="hl opt">==</span><span class="hl num">TRUE</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">getmode</span><span class="hl std">(attrib2</span><span class="hl opt">$</span><span class="hl std">Price)</span>
<span class="hl std">attrib2</span><span class="hl opt">$</span><span class="hl std">Season[</span><span class="hl kwd">is.na</span><span class="hl std">(attrib2</span><span class="hl opt">$</span><span class="hl std">Season)</span> <span class="hl opt">==</span><span class="hl num">TRUE</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">getmode</span><span class="hl std">(attrib2</span><span class="hl opt">$</span><span class="hl std">Season)</span>
<span class="hl std">attrib2</span><span class="hl opt">$</span><span class="hl std">NeckLine[</span><span class="hl kwd">is.na</span><span class="hl std">(attrib2</span><span class="hl opt">$</span><span class="hl std">NeckLine)</span> <span class="hl opt">==</span><span class="hl num">TRUE</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">getmode</span><span class="hl std">(attrib2</span><span class="hl opt">$</span><span class="hl std">NeckLine)</span>
<span class="hl std">attrib2</span><span class="hl opt">$</span><span class="hl std">waiseline[</span><span class="hl kwd">is.na</span><span class="hl std">(attrib2</span><span class="hl opt">$</span><span class="hl std">waiseline)</span> <span class="hl opt">==</span><span class="hl num">TRUE</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">getmode</span><span class="hl std">(attrib2</span><span class="hl opt">$</span><span class="hl std">waiseline)</span>
<span class="hl std">attrib2</span><span class="hl opt">$</span><span class="hl std">Material[</span><span class="hl kwd">is.na</span><span class="hl std">(attrib2</span><span class="hl opt">$</span><span class="hl std">Material)</span> <span class="hl opt">==</span><span class="hl num">TRUE</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">getmode</span><span class="hl std">(attrib2</span><span class="hl opt">$</span><span class="hl std">Material)</span>
<span class="hl std">attrib2</span><span class="hl opt">$</span><span class="hl std">FabricType[</span><span class="hl kwd">is.na</span><span class="hl std">(attrib2</span><span class="hl opt">$</span><span class="hl std">FabricType)</span> <span class="hl opt">==</span><span class="hl num">TRUE</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">getmode</span><span class="hl std">(attrib2</span><span class="hl opt">$</span><span class="hl std">FabricType)</span>
<span class="hl std">attrib2</span><span class="hl opt">$</span><span class="hl std">Decoration[</span><span class="hl kwd">is.na</span><span class="hl std">(attrib2</span><span class="hl opt">$</span><span class="hl std">Decoration)</span> <span class="hl opt">==</span><span class="hl num">TRUE</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">getmode</span><span class="hl std">(attrib2</span><span class="hl opt">$</span><span class="hl std">Decoration)</span>
<span class="hl std">attrib2</span><span class="hl opt">$</span><span class="hl std">`Pattern Type`[</span><span class="hl kwd">is.na</span><span class="hl std">(attrib2</span><span class="hl opt">$</span><span class="hl std">`Pattern Type`)</span> <span class="hl opt">==</span><span class="hl num">TRUE</span><span class="hl std">]</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">getmode</span><span class="hl std">(attrib2</span><span class="hl opt">$</span><span class="hl std">`Pattern Type`)</span>
<span class="hl std">attrib2data</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">data.frame</span><span class="hl std">(attrib2)</span>
<span class="hl kwd">str</span><span class="hl std">(attrib2data)</span>
</pre></div>
<div class="output"><pre class="knitr r">## 'data.frame':	500 obs. of  13 variables:
##  $ Style         : Factor w/ 12 levels &quot;bohemian&quot;,&quot;Brief&quot;,..: 10 3 11 2 4 1 3 7 6 1 ...
##  $ Price         : Factor w/ 5 levels &quot;Average&quot;,&quot;High&quot;,..: 3 3 2 1 3 3 1 1 1 3 ...
##  $ Rating        : num  4.6 0 0 4.6 4.5 0 0 0 0 0 ...
##  $ Size          : Factor w/ 5 levels &quot;free&quot;,&quot;L&quot;,&quot;M&quot;,..: 3 2 2 2 3 3 5 1 1 1 ...
##  $ Season        : Factor w/ 4 levels &quot;Autumn&quot;,&quot;Spring&quot;,..: 3 3 1 2 3 3 3 1 2 3 ...
##  $ NeckLine      : Factor w/ 16 levels &quot;backless&quot;,&quot;boat-neck&quot;,..: 7 7 7 7 7 16 7 7 16 16 ...
##  $ SleeveLength  : Factor w/ 13 levels &quot;butterfly&quot;,&quot;cap-sleeves&quot;,..: 10 8 4 4 1 10 4 9 9 10 ...
##  $ waiseline     : Factor w/ 5 levels &quot;dropped&quot;,&quot;empire&quot;,..: 2 3 3 3 3 2 4 3 2 3 ...
##  $ Material      : Factor w/ 24 levels &quot;acrylic&quot;,&quot;cashmere&quot;,..: 14 9 17 20 3 14 4 17 4 15 ...
##  $ FabricType    : Factor w/ 18 levels &quot;batik&quot;,&quot;broadcloth&quot;,..: 3 10 10 3 3 10 10 2 2 3 ...
##  $ Decoration    : Factor w/ 24 levels &quot;applique&quot;,&quot;beading&quot;,..: 20 20 13 8 3 13 13 12 2 13 ...
##  $ Pattern.Type  : Factor w/ 13 levels &quot;animal&quot;,&quot;character&quot;,..: 1 1 10 10 3 10 11 7 11 7 ...
##  $ Recommendation: Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 2 1 1 2 1 1 1 1 2 2 ...
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">#Dresses dataset</span>
<span class="hl kwd">head</span><span class="hl std">(dresssale2)</span>
</pre></div>
<div class="output"><pre class="knitr r">## # A tibble: 6 x 23
##   `29/8/2013` `31/8/2013` `41314` `41373` `41434` `41495` `41556` `41617`
##         &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;  
## 1        2114        2274    2491    2660    2727    2887    2930 3119   
## 2         151         275     570     750     813    1066    1164 1558   
## 3           6           7       7       7       8       8       9 10     
## 4        1005        1128    1326    1455    1507    1621    1637 1723   
## 5         996        1175    1304    1396    1432    1559    1570 1638   
## 6           4           5      11      13      13      13      16 18     
## # … with 15 more variables: `14/9/2013` &lt;chr&gt;, `16/9/2013` &lt;chr&gt;,
## #   `18/9/2013` &lt;chr&gt;, `20/9/2013` &lt;chr&gt;, `22/9/2013` &lt;chr&gt;, `24/9/2013` &lt;dbl&gt;,
## #   `26/9/2013` &lt;dbl&gt;, `28/9/2013` &lt;dbl&gt;, `30/9/2013` &lt;dbl&gt;, `41315` &lt;dbl&gt;,
## #   `41374` &lt;dbl&gt;, `41435` &lt;dbl&gt;, `40400` &lt;dbl&gt;, `41557` &lt;dbl&gt;, `41618` &lt;dbl&gt;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">names</span><span class="hl std">(dresssale2)</span>
</pre></div>
<div class="output"><pre class="knitr r">##  [1] &quot;29/8/2013&quot; &quot;31/8/2013&quot; &quot;41314&quot;     &quot;41373&quot;     &quot;41434&quot;     &quot;41495&quot;    
##  [7] &quot;41556&quot;     &quot;41617&quot;     &quot;14/9/2013&quot; &quot;16/9/2013&quot; &quot;18/9/2013&quot; &quot;20/9/2013&quot;
## [13] &quot;22/9/2013&quot; &quot;24/9/2013&quot; &quot;26/9/2013&quot; &quot;28/9/2013&quot; &quot;30/9/2013&quot; &quot;41315&quot;    
## [19] &quot;41374&quot;     &quot;41435&quot;     &quot;40400&quot;     &quot;41557&quot;     &quot;41618&quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Update columns name in dresssale2 dataset</span>
<span class="hl com"># Change any column names you want to, all at once</span>
<span class="hl kwd">colnames</span><span class="hl std">(dresssale2)[</span><span class="hl kwd">colnames</span><span class="hl std">(dresssale2)</span> <span class="hl opt">%in%</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;41314&quot;</span><span class="hl std">,</span><span class="hl str">&quot;41373&quot;</span><span class="hl std">,</span><span class="hl str">&quot;41434&quot;</span><span class="hl std">,</span><span class="hl str">&quot;41495&quot;</span><span class="hl std">,</span><span class="hl str">&quot;41556&quot;</span><span class="hl std">,</span><span class="hl str">&quot;41617&quot;</span><span class="hl std">,</span><span class="hl str">&quot;41315&quot;</span><span class="hl std">,</span><span class="hl str">&quot;41374&quot;</span><span class="hl std">,</span><span class="hl str">&quot;41435&quot;</span><span class="hl std">,</span><span class="hl str">&quot;40400&quot;</span><span class="hl std">,</span><span class="hl str">&quot;41557&quot;</span><span class="hl std">,</span><span class="hl str">&quot;41618&quot;</span><span class="hl std">)]</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;2/9/2013&quot;</span><span class="hl std">,</span><span class="hl str">&quot;4/9/2013&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;6/9/2013&quot;</span><span class="hl std">,</span><span class="hl str">&quot;8/9/2013&quot;</span><span class="hl std">,</span><span class="hl str">&quot;10/9/2013&quot;</span><span class="hl std">,</span><span class="hl str">&quot;12/9/2013&quot;</span><span class="hl std">,</span><span class="hl str">&quot;2/10/2013&quot;</span><span class="hl std">,</span><span class="hl str">&quot;4/10/2013&quot;</span><span class="hl std">,</span><span class="hl str">&quot;6/10/2013&quot;</span><span class="hl std">,</span><span class="hl str">&quot;8/10/2013&quot;</span><span class="hl std">,</span><span class="hl str">&quot;10/10/2013&quot;</span><span class="hl std">,</span><span class="hl str">&quot;12/10/2013&quot;</span><span class="hl std">)</span>
<span class="hl com"># names(dresssale2) &lt;- c(&quot;29/8/2013&quot;, &quot;31/8/2013&quot;, &quot;2/9/2013&quot;,     &quot;41373&quot;  ,   &quot;41434&quot; ,    &quot;41495&quot;  ,   &quot;41556&quot; ,    &quot;41617&quot;,    </span>
<span class="hl com">#                       &quot;14/9/2013&quot;, &quot;16/9/2013&quot; ,&quot;18/9/2013&quot;, &quot;20/9/2013&quot;, &quot;22/9/2013&quot;, &quot;24/9/2013&quot;, &quot;26/9/2013&quot;, &quot;28/9/2013&quot;,</span>
<span class="hl com">#                       &quot;30/9/2013&quot;, &quot;41315&quot;,     &quot;41374&quot;,     &quot;41435&quot;,     &quot;40400&quot;    , &quot;41557&quot; ,    &quot;41618&quot;)</span>

<span class="hl kwd">head</span><span class="hl std">(dresssale2)</span>
</pre></div>
<div class="output"><pre class="knitr r">## # A tibble: 6 x 23
##   `29/8/2013` `31/8/2013` `2/9/2013` `4/9/2013` `6/9/2013` `8/9/2013`
##         &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
## 1        2114        2274       2491       2660       2727       2887
## 2         151         275        570        750        813       1066
## 3           6           7          7          7          8          8
## 4        1005        1128       1326       1455       1507       1621
## 5         996        1175       1304       1396       1432       1559
## 6           4           5         11         13         13         13
## # … with 17 more variables: `10/9/2013` &lt;dbl&gt;, `12/9/2013` &lt;chr&gt;,
## #   `14/9/2013` &lt;chr&gt;, `16/9/2013` &lt;chr&gt;, `18/9/2013` &lt;chr&gt;, `20/9/2013` &lt;chr&gt;,
## #   `22/9/2013` &lt;chr&gt;, `24/9/2013` &lt;dbl&gt;, `26/9/2013` &lt;dbl&gt;, `28/9/2013` &lt;dbl&gt;,
## #   `30/9/2013` &lt;dbl&gt;, `2/10/2013` &lt;dbl&gt;, `4/10/2013` &lt;dbl&gt;, `6/10/2013` &lt;dbl&gt;,
## #   `8/10/2013` &lt;dbl&gt;, `10/10/2013` &lt;dbl&gt;, `12/10/2013` &lt;dbl&gt;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Convert all variable types to numeric</span>
<span class="hl std">dresssale2</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">as.data.frame</span><span class="hl std">(</span><span class="hl kwd">apply</span><span class="hl std">(dresssale2,</span> <span class="hl num">2</span><span class="hl std">, as.numeric))</span>
</pre></div>
<div class="warning"><pre class="knitr r">## Warning in apply(dresssale2, 2, as.numeric): NAs introduced by coercion
</pre></div>
<div class="warning"><pre class="knitr r">## Warning in apply(dresssale2, 2, as.numeric): NAs introduced by coercion

## Warning in apply(dresssale2, 2, as.numeric): NAs introduced by coercion

## Warning in apply(dresssale2, 2, as.numeric): NAs introduced by coercion

## Warning in apply(dresssale2, 2, as.numeric): NAs introduced by coercion

## Warning in apply(dresssale2, 2, as.numeric): NAs introduced by coercion
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># mean row </span>
<span class="hl std">dresssale2</span> <span class="hl kwb">=</span> <span class="hl kwd">as.matrix</span><span class="hl std">(dresssale2)</span>
<span class="hl std">k</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">which</span><span class="hl std">(</span><span class="hl kwd">is.na</span><span class="hl std">(dresssale2),</span> <span class="hl kwc">arr.ind</span><span class="hl std">=</span><span class="hl num">TRUE</span><span class="hl std">)</span>
<span class="hl std">dresssale2[k]</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">rowMeans</span><span class="hl std">(dresssale2,</span> <span class="hl kwc">na.rm</span><span class="hl std">=</span><span class="hl num">TRUE</span><span class="hl std">)[k[,</span><span class="hl num">1</span><span class="hl std">]]</span>
<span class="hl std">dresssale2</span> <span class="hl kwb">=</span> <span class="hl kwd">as.data.frame</span><span class="hl std">(dresssale2)</span>

<span class="hl com"># sum all values on row on (total sales column)-New column created </span>
<span class="hl std">dresssale2</span><span class="hl opt">$</span><span class="hl std">total_sales</span> <span class="hl kwb">=</span> <span class="hl kwd">rowSums</span><span class="hl std">(dresssale2)</span>
<span class="hl kwd">head</span><span class="hl std">(dresssale2)</span>
</pre></div>
<div class="output"><pre class="knitr r">##   29/8/2013 31/8/2013 2/9/2013 4/9/2013 6/9/2013 8/9/2013 10/9/2013 12/9/2013
## 1      2114      2274     2491     2660     2727     2887      2930      3119
## 2       151       275      570      750      813     1066      1164      1558
## 3         6         7        7        7        8        8         9        10
## 4      1005      1128     1326     1455     1507     1621      1637      1723
## 5       996      1175     1304     1396     1432     1559      1570      1638
## 6         4         5       11       13       13       13        16        18
##   14/9/2013 16/9/2013 18/9/2013 20/9/2013 22/9/2013 24/9/2013 26/9/2013
## 1      3204      3277      3321      3386      3479      3554      3624
## 2      1756      1878      1985      2106      2454      2710      2942
## 3        10        10        10        10        11        11        11
## 4      1746      1783      1796      1812      1845      1878      1892
## 5      1655      1681      1743      1824      1919      2032      2156
## 6        19        20        20        21        22        25        25
##   28/9/2013 30/9/2013 2/10/2013 4/10/2013 6/10/2013 8/10/2013 10/10/2013
## 1      3706      3746      3795      3832      3897      3923       3985
## 2      3258      3354      3475      3654      3911      4024       4125
## 3        11        11        11        11        11        11         11
## 4      1914      1924      1929      1941      1952      1955       1959
## 5      2252      2312      2387      2459      2544      2614       2693
## 6        26        26        26        26        27        27         27
##   12/10/2013 total_sales
## 1       4048       75979
## 2       4277       52256
## 3         11         223
## 4       1963       39691
## 5       2736       44077
## 6         27         457
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">#Merged data</span>
<span class="hl std">merged_data</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">data.frame</span><span class="hl std">(attrib2 ,dresssale2)</span>
<span class="hl kwd">head</span><span class="hl std">(merged_data)</span>
</pre></div>
<div class="output"><pre class="knitr r">##      Style   Price Rating Size Season NeckLine SleeveLength waiseline
## 1     Sexy     Low    4.6    M Summer   o-neck   sleeveless    empire
## 2   Casual     Low    0.0    L Summer   o-neck        Petal   natural
## 3  vintage    High    0.0    L Autumn   o-neck         full   natural
## 4    Brief Average    4.6    L Spring   o-neck         full   natural
## 5     cute     Low    4.5    M Summer   o-neck    butterfly   natural
## 6 bohemian     Low    0.0    M Summer   v-neck   sleeveless    empire
##        Material FabricType Decoration Pattern.Type Recommendation X29.8.2013
## 1          null    chiffon    ruffles       animal              1       2114
## 2    microfiber       null    ruffles       animal              0        151
## 3      polyster       null       null        print              0          6
## 4          silk    chiffon embroidery        print              1       1005
## 5 chiffonfabric    chiffon        bow          dot              0        996
## 6          null       null       null        print              0          4
##   X31.8.2013 X2.9.2013 X4.9.2013 X6.9.2013 X8.9.2013 X10.9.2013 X12.9.2013
## 1       2274      2491      2660      2727      2887       2930       3119
## 2        275       570       750       813      1066       1164       1558
## 3          7         7         7         8         8          9         10
## 4       1128      1326      1455      1507      1621       1637       1723
## 5       1175      1304      1396      1432      1559       1570       1638
## 6          5        11        13        13        13         16         18
##   X14.9.2013 X16.9.2013 X18.9.2013 X20.9.2013 X22.9.2013 X24.9.2013 X26.9.2013
## 1       3204       3277       3321       3386       3479       3554       3624
## 2       1756       1878       1985       2106       2454       2710       2942
## 3         10         10         10         10         11         11         11
## 4       1746       1783       1796       1812       1845       1878       1892
## 5       1655       1681       1743       1824       1919       2032       2156
## 6         19         20         20         21         22         25         25
##   X28.9.2013 X30.9.2013 X2.10.2013 X4.10.2013 X6.10.2013 X8.10.2013 X10.10.2013
## 1       3706       3746       3795       3832       3897       3923        3985
## 2       3258       3354       3475       3654       3911       4024        4125
## 3         11         11         11         11         11         11          11
## 4       1914       1924       1929       1941       1952       1955        1959
## 5       2252       2312       2387       2459       2544       2614        2693
## 6         26         26         26         26         27         27          27
##   X12.10.2013 total_sales
## 1        4048       75979
## 2        4277       52256
## 3          11         223
## 4        1963       39691
## 5        2736       44077
## 6          27         457
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">str</span><span class="hl std">(merged_data)</span>
</pre></div>
<div class="output"><pre class="knitr r">## 'data.frame':	500 obs. of  37 variables:
##  $ Style         : Factor w/ 12 levels &quot;bohemian&quot;,&quot;Brief&quot;,..: 10 3 11 2 4 1 3 7 6 1 ...
##  $ Price         : Factor w/ 5 levels &quot;Average&quot;,&quot;High&quot;,..: 3 3 2 1 3 3 1 1 1 3 ...
##  $ Rating        : num  4.6 0 0 4.6 4.5 0 0 0 0 0 ...
##  $ Size          : Factor w/ 5 levels &quot;free&quot;,&quot;L&quot;,&quot;M&quot;,..: 3 2 2 2 3 3 5 1 1 1 ...
##  $ Season        : Factor w/ 4 levels &quot;Autumn&quot;,&quot;Spring&quot;,..: 3 3 1 2 3 3 3 1 2 3 ...
##  $ NeckLine      : Factor w/ 16 levels &quot;backless&quot;,&quot;boat-neck&quot;,..: 7 7 7 7 7 16 7 7 16 16 ...
##  $ SleeveLength  : Factor w/ 13 levels &quot;butterfly&quot;,&quot;cap-sleeves&quot;,..: 10 8 4 4 1 10 4 9 9 10 ...
##  $ waiseline     : Factor w/ 5 levels &quot;dropped&quot;,&quot;empire&quot;,..: 2 3 3 3 3 2 4 3 2 3 ...
##  $ Material      : Factor w/ 24 levels &quot;acrylic&quot;,&quot;cashmere&quot;,..: 14 9 17 20 3 14 4 17 4 15 ...
##  $ FabricType    : Factor w/ 18 levels &quot;batik&quot;,&quot;broadcloth&quot;,..: 3 10 10 3 3 10 10 2 2 3 ...
##  $ Decoration    : Factor w/ 24 levels &quot;applique&quot;,&quot;beading&quot;,..: 20 20 13 8 3 13 13 12 2 13 ...
##  $ Pattern.Type  : Factor w/ 13 levels &quot;animal&quot;,&quot;character&quot;,..: 1 1 10 10 3 10 11 7 11 7 ...
##  $ Recommendation: Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 2 1 1 2 1 1 1 1 2 2 ...
##  $ X29.8.2013    : num  2114 151 6 1005 996 ...
##  $ X31.8.2013    : num  2274 275 7 1128 1175 ...
##  $ X2.9.2013     : num  2491 570 7 1326 1304 ...
##  $ X4.9.2013     : num  2660 750 7 1455 1396 ...
##  $ X6.9.2013     : num  2727 813 8 1507 1432 ...
##  $ X8.9.2013     : num  2887 1066 8 1621 1559 ...
##  $ X10.9.2013    : num  2930 1164 9 1637 1570 ...
##  $ X12.9.2013    : num  3119 1558 10 1723 1638 ...
##  $ X14.9.2013    : num  3204 1756 10 1746 1655 ...
##  $ X16.9.2013    : num  3277 1878 10 1783 1681 ...
##  $ X18.9.2013    : num  3321 1985 10 1796 1743 ...
##  $ X20.9.2013    : num  3386 2106 10 1812 1824 ...
##  $ X22.9.2013    : num  3479 2454 11 1845 1919 ...
##  $ X24.9.2013    : num  3554 2710 11 1878 2032 ...
##  $ X26.9.2013    : num  3624 2942 11 1892 2156 ...
##  $ X28.9.2013    : num  3706 3258 11 1914 2252 ...
##  $ X30.9.2013    : num  3746 3354 11 1924 2312 ...
##  $ X2.10.2013    : num  3795 3475 11 1929 2387 ...
##  $ X4.10.2013    : num  3832 3654 11 1941 2459 ...
##  $ X6.10.2013    : num  3897 3911 11 1952 2544 ...
##  $ X8.10.2013    : num  3923 4024 11 1955 2614 ...
##  $ X10.10.2013   : num  3985 4125 11 1959 2693 ...
##  $ X12.10.2013   : num  4048 4277 11 1963 2736 ...
##  $ total_sales   : num  75979 52256 223 39691 44077 ...
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># spliting dataset </span>
<span class="hl kwd">set.seed</span><span class="hl std">(</span><span class="hl num">100</span><span class="hl std">)</span>
<span class="hl std">spl</span> <span class="hl kwb">=</span> <span class="hl kwd">sample.split</span><span class="hl std">(merged_data</span><span class="hl opt">$</span><span class="hl std">Recommendation,</span> <span class="hl kwc">SplitRatio</span> <span class="hl std">=</span> <span class="hl num">0.7</span><span class="hl std">)</span>
<span class="hl std">train</span> <span class="hl kwb">=</span> <span class="hl kwd">subset</span><span class="hl std">(merged_data, spl</span><span class="hl opt">==</span><span class="hl num">TRUE</span><span class="hl std">)</span>
<span class="hl std">test</span> <span class="hl kwb">=</span> <span class="hl kwd">subset</span><span class="hl std">(merged_data, spl</span><span class="hl opt">==</span><span class="hl num">FALSE</span><span class="hl std">)</span>
<span class="hl kwd">print</span><span class="hl std">(</span><span class="hl kwd">dim</span><span class="hl std">(train));</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 350  37
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">print</span><span class="hl std">(</span><span class="hl kwd">dim</span><span class="hl std">(test))</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 150  37
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">#Classification - Predict recommendation</span>
<span class="hl com">#First model (Naive Bayes): # non-linear model # simple &amp; fast</span>
<span class="hl kwd">options</span><span class="hl std">(</span><span class="hl kwc">scipen</span> <span class="hl std">=</span> <span class="hl num">999</span><span class="hl std">)</span>
<span class="hl std">naive_model</span> <span class="hl kwb">=</span> <span class="hl kwd">naiveBayes</span><span class="hl std">(Recommendation</span> <span class="hl opt">~</span><span class="hl std">.,</span><span class="hl kwc">data</span> <span class="hl std">= train)</span> <span class="hl com"># build model # . means all column</span>
<span class="hl kwd">confusionMatrix</span><span class="hl std">(train</span><span class="hl opt">$</span><span class="hl std">Recommendation,</span> <span class="hl kwd">predict</span><span class="hl std">(naive_model,train),</span> <span class="hl kwc">positive</span> <span class="hl std">=</span> <span class="hl str">'1'</span><span class="hl std">)</span> <span class="hl com"># create confusion Matrix</span>
</pre></div>
<div class="output"><pre class="knitr r">## Confusion Matrix and Statistics
## 
##           Reference
## Prediction   0   1
##          0 136  67
##          1  41 106
##                                            
##                Accuracy : 0.6914           
##                  95% CI : (0.6401, 0.7394) 
##     No Information Rate : 0.5057           
##     P-Value [Acc &gt; NIR] : 0.000000000001409
##                                            
##                   Kappa : 0.3817           
##                                            
##  Mcnemar's Test P-Value : 0.01614          
##                                            
##             Sensitivity : 0.6127           
##             Specificity : 0.7684           
##          Pos Pred Value : 0.7211           
##          Neg Pred Value : 0.6700           
##              Prevalence : 0.4943           
##          Detection Rate : 0.3029           
##    Detection Prevalence : 0.4200           
##       Balanced Accuracy : 0.6905           
##                                            
##        'Positive' Class : 1                
## 
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">naive_predict</span> <span class="hl kwb">=</span> <span class="hl kwd">predict</span><span class="hl std">(naive_model,test)</span>  <span class="hl com"># predict test set</span>
<span class="hl kwd">table</span><span class="hl std">(naive_predict,test</span><span class="hl opt">$</span><span class="hl std">Recommendation)</span>  <span class="hl com"># create table</span>
</pre></div>
<div class="output"><pre class="knitr r">##              
## naive_predict  0  1
##             0 50 30
##             1 37 33
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Support vector machine (SVM): # Linear model # complex</span>
<span class="hl std">svm_model</span> <span class="hl kwb">=</span> <span class="hl kwd">svm</span><span class="hl std">(Recommendation</span> <span class="hl opt">~</span><span class="hl std">.,train)</span> <span class="hl com"># build model</span>
<span class="hl kwd">confusionMatrix</span><span class="hl std">(train</span><span class="hl opt">$</span><span class="hl std">Recommendation,</span><span class="hl kwd">predict</span><span class="hl std">(svm_model),</span><span class="hl kwc">positive</span> <span class="hl std">=</span> <span class="hl str">'1'</span><span class="hl std">)</span> <span class="hl com"># create confusion Matrix</span>
</pre></div>
<div class="output"><pre class="knitr r">## Confusion Matrix and Statistics
## 
##           Reference
## Prediction   0   1
##          0 203   0
##          1 141   6
##                                              
##                Accuracy : 0.5971             
##                  95% CI : (0.5437, 0.6489)   
##     No Information Rate : 0.9829             
##     P-Value [Acc &gt; NIR] : 1                  
##                                              
##                   Kappa : 0.047              
##                                              
##  Mcnemar's Test P-Value : &lt;0.0000000000000002
##                                              
##             Sensitivity : 1.00000            
##             Specificity : 0.59012            
##          Pos Pred Value : 0.04082            
##          Neg Pred Value : 1.00000            
##              Prevalence : 0.01714            
##          Detection Rate : 0.01714            
##    Detection Prevalence : 0.42000            
##       Balanced Accuracy : 0.79506            
##                                              
##        'Positive' Class : 1                  
## 
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">svm_predict</span> <span class="hl kwb">=</span> <span class="hl kwd">predict</span><span class="hl std">(svm_model,test)</span> <span class="hl com"># predict test set</span>
<span class="hl kwd">table</span><span class="hl std">(svm_predict,test</span><span class="hl opt">$</span><span class="hl std">Recommendation)</span> <span class="hl com"># create table</span>
</pre></div>
<div class="output"><pre class="knitr r">##            
## svm_predict  0  1
##           0 85 61
##           1  2  2
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># Third model (Random Forest) </span>
<span class="hl std">randomForest_model</span> <span class="hl kwb">=</span> <span class="hl kwd">randomForest</span><span class="hl std">(</span><span class="hl kwc">x</span> <span class="hl std">= train,</span> <span class="hl kwc">y</span> <span class="hl std">= train</span><span class="hl opt">$</span><span class="hl std">Recommendation,</span><span class="hl kwc">ntree</span> <span class="hl std">=</span><span class="hl num">800</span><span class="hl std">)</span> <span class="hl com"># build model</span>
<span class="hl kwd">confusionMatrix</span><span class="hl std">(train</span><span class="hl opt">$</span><span class="hl std">Recommendation,</span><span class="hl kwd">predict</span><span class="hl std">(randomForest_model),</span><span class="hl kwc">positive</span> <span class="hl std">=</span> <span class="hl str">'1'</span><span class="hl std">)</span> <span class="hl com"># create confusion Matrix</span>
</pre></div>
<div class="output"><pre class="knitr r">## Confusion Matrix and Statistics
## 
##           Reference
## Prediction   0   1
##          0 203   0
##          1   0 147
##                                                
##                Accuracy : 1                    
##                  95% CI : (0.9895, 1)          
##     No Information Rate : 0.58                 
##     P-Value [Acc &gt; NIR] : &lt; 0.00000000000000022
##                                                
##                   Kappa : 1                    
##                                                
##  Mcnemar's Test P-Value : NA                   
##                                                
##             Sensitivity : 1.00                 
##             Specificity : 1.00                 
##          Pos Pred Value : 1.00                 
##          Neg Pred Value : 1.00                 
##              Prevalence : 0.42                 
##          Detection Rate : 0.42                 
##    Detection Prevalence : 0.42                 
##       Balanced Accuracy : 1.00                 
##                                                
##        'Positive' Class : 1                    
## 
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">randomForest_predict</span> <span class="hl kwb">=</span> <span class="hl kwd">predict</span><span class="hl std">(randomForest_model,test)</span> <span class="hl com"># predict test set</span>
<span class="hl kwd">table</span><span class="hl std">(randomForest_predict,test</span><span class="hl opt">$</span><span class="hl std">Recommendation )</span> <span class="hl com"># create table</span>
</pre></div>
<div class="output"><pre class="knitr r">##                     
## randomForest_predict  0  1
##                    0 87  0
##                    1  0 63
</pre></div>
</div></div>

<p>You can also embed plots, for example:</p>



<script defer src="https://static.cloudflareinsights.com/beacon.min.js/v2cb3a2ab87c5498db5ce7e6608cf55231689030342039" integrity="sha512-DI3rPuZDcpH/mSGyN22erN5QFnhl760f50/te7FTIYxodEF8jJnSFnfnmG/c+osmIQemvUrnBtxnMpNdzvx1/g==" data-cf-beacon='{"rayId":"7e634f75cbfb07ad","token":"a73834a4a1444e9ab89e8da06da41720","version":"2023.4.0","si":100}' crossorigin="anonymous"></script>
</body>
</html>
